import XCTest

final class BitBuilderTest: XCTestCase {

    func testBitBuilder() throws {
        // should serialize uint
        try testWriteUint()
        
        // TODO: - create tests for int, coins, address
    }
    
    private func testWriteUint() throws {
        let cases: [(UInt32, Int, String)] = [
            (10290, 29, "00014194_"),
            (41732, 27, "0014609_"),
            (62757, 22, "03D496_"),
            (44525, 16, "ADED"),
            (26925, 30, "0001A4B6_"),
            (52948, 27, "0019DA9_"),
            (12362, 20, "0304A"),
            (31989, 16, "7CF5"),
            (8503, 21, "0109BC_"),
            (54308, 17, "6A124_"),
            (61700, 25, "0078824_"),
            (63112, 20, "0F688"),
            (27062, 29, "00034DB4_"),
            (37994, 30, "000251AA_"),
            (47973, 27, "00176CB_"),
            (18996, 25, "00251A4_"),
            (34043, 21, "0427DC_"),
            (8234, 18, "080AA_"),
            (16218, 26, "000FD6A_"),
            (40697, 25, "004F7CC_"),
            (43740, 27, "00155B9_"),
            (35773, 31, "0001177B_"),
            (32916, 18, "20252_"),
            (1779, 24, "0006F3"),
            (35968, 17, "46404_"),
            (15503, 23, "00791F_"),
            (25860, 21, "032824_"),
            (20651, 29, "0002855C_"),
            (14369, 16, "3821"),
            (28242, 24, "006E52"),
            (28446, 18, "1BC7A_"),
            (48685, 16, "BE2D"),
            (54822, 18, "3589A_"),
            (50042, 22, "030DEA_"),
            (11024, 30, "0000AC42_"),
            (44958, 26, "002BE7A_"),
            (20297, 27, "0009E93_"),
            (24757, 16, "60B5"),
            (36043, 29, "0004665C_"),
            (24210, 16, "5E92"),
            (49621, 29, "00060EAC_"),
            (63571, 17, "7C29C_"),
            (16047, 24, "003EAF"),
            (61384, 27, "001DF91_"),
            (57607, 25, "007083C_"),
            (32945, 30, "000202C6_"),
            (31215, 29, "0003CF7C_"),
            (3088, 21, "006084_"),
            (45519, 24, "00B1CF"),
            (53126, 26, "0033E1A_")
        ]
        
        for c in cases {
            let builder = BitBuilder()
            try builder.writeUint(value: c.0, bits: c.1)
            let bits = try builder.build()
            XCTAssertEqual(try bits.toString(), c.2)
        }
    }
}
